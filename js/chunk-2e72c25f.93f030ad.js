(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2e72c25f"],{"50c6":function(t,e,a){"use strict";a.d(e,"a",(function(){return n}));var o=a("9bd2");function n(t){return Object(o["a"])({url:"/admin/disable",method:"get",params:t,withCredentials:!0})}},"515f":function(t,e,a){},ce0c:function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("d2-container",[a("div",[a("el-dialog",{attrs:{title:t.detailTitle,visible:t.dialogFormVisibleok,modal:!1},on:{"update:visible":function(e){t.dialogFormVisibleok=e}}},[a("el-row",[a("el-col",{attrs:{span:8}},[a("div",{staticClass:"o1"},[t._v("代理详情：")])])],1),a("el-row",[a("el-col",{attrs:{span:12}},[a("div",{staticClass:"o2"},[t._v("公司名："+t._s(t.rulesForm2.companyName))])]),a("el-col",{attrs:{span:12}},[a("div",{staticClass:"o2"},[t._v("绑定域名："+t._s(t.rulesForm2.domain))])])],1),a("el-row",[a("el-col",{attrs:{span:12}},[a("div",{staticClass:"o2"},[t._v("创建时间："+t._s(t.rulesForm2.created_at))])]),a("el-col",{attrs:{span:12}},[a("div",{staticClass:"o2"},[t._v("LOGO："),a("img",{attrs:{src:"/image/theme/d2/logo/all.png"}})])])],1),a("el-row",[a("el-col",{attrs:{span:8}},[a("div",{staticClass:"o1 o6"},[t._v("其他：")])])],1),a("el-row",[a("el-col",{attrs:{span:12}},[a("div",{staticClass:"o2"},[t._v("电话："),a("span",[t._v(t._s(t.rulesForm2.tel))])])])],1)],1),a("el-dialog",{attrs:{title:t.title,visible:t.dialogFormVisible2,"append-to-body":!0},on:{"update:visible":function(e){t.dialogFormVisible2=e}}},[a("el-form",{ref:"rulesForm",attrs:{model:t.rulesForm,rules:t.rules}},[a("el-form-item",{attrs:{prop:"companyName",required:""}},[a("div",{staticClass:"typename required"},[t._v("公司名：")]),a("el-input",{model:{value:t.rulesForm.companyName,callback:function(e){t.$set(t.rulesForm,"companyName",e)},expression:"rulesForm.companyName"}})],1),a("el-form-item",{attrs:{prop:"domain",required:""}},[a("div",{staticClass:"typename required"},[t._v("域名：")]),a("el-input",{model:{value:t.rulesForm.domain,callback:function(e){t.$set(t.rulesForm,"domain",e)},expression:"rulesForm.domain"}})],1),a("el-form-item",{attrs:{prop:"level",required:""}},[a("div",{staticClass:"typename required"},[t._v("层级：")]),a("el-input",{model:{value:t.rulesForm.level,callback:function(e){t.$set(t.rulesForm,"level",t._n(e))},expression:"rulesForm.level"}})],1),a("el-form-item",{attrs:{prop:"logo"}},[a("div",{staticClass:"typename required"},[t._v("LOGO：")]),a("el-upload",{ref:"upload",attrs:{action:t.uploadAction,"on-change":t.imageChange,"list-type":"picture-card",name:"logo",data:t.paramsData,limit:1,multiple:!1,"auto-upload":!1,"on-preview":t.handlePictureCardPreview,"on-remove":t.handleRemovePicture,"on-error":t.createerror,"on-success":t.createSuccess,"file-list":t.fileList}},[a("i",{staticClass:"el-icon-plus"})]),a("el-dialog",{attrs:{visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("img",{attrs:{width:"100%",src:t.dialogImageUrl,alt:""}})])],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogFormVisible2=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.next1}},[t._v("更新")])],1)],1)],1),a("el-card",{staticClass:"m-box-card",staticStyle:{padding:"0","margin-bottom":"6px"},attrs:{shadow:"hover"}},[a("el-row",[a("el-col",{staticStyle:{width:"20%"}},[a("div",{staticClass:"inputok"},[a("div",{staticClass:"input2"},[t._v("代理名：")]),a("el-input",{staticClass:"input3",model:{value:t.formdata.name,callback:function(e){t.$set(t.formdata,"name",e)},expression:"formdata.name"}})],1)]),a("el-col",{staticClass:"searchok"},[a("div",{staticClass:"search"},[a("el-button",{attrs:{type:"primary"},on:{click:t.searchok2}},[t._v("刷新")]),a("el-button",{attrs:{type:"primary"},on:{click:t.searchok}},[t._v("查询")]),a("el-button",{on:{click:t.emptysearch}},[t._v("重置")])],1)])],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{data:t.tableData1,"row-key":"try",border:"",lazy:"",load:t.load,"tree-props":{children:"children",hasChildren:"hasChildren"}}},[a("el-table-column",{attrs:{prop:"companyName",label:"代理名",width:"300"}}),a("el-table-column",{attrs:{prop:"rid",label:"上级代理"}}),a("el-table-column",{attrs:{prop:"domain",label:"域名",width:"200"}}),a("el-table-column",{attrs:{prop:"tel",label:"手机号"}}),a("el-table-column",{attrs:{prop:"amount",label:"余额"}}),a("el-table-column",{attrs:{prop:"level",label:"级别"}}),a("el-table-column",{attrs:{prop:"region",label:"区域"}}),a("el-table-column",{attrs:{prop:"created_at",label:"注册时间",width:"200"}}),a("el-table-column",{attrs:{label:"操作",fixed:"right",width:"330"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){return t.agentLogin(e.row)}}},[t._v("登录")]),a("el-button",{attrs:{size:"mini"},on:{click:function(a){return t.agentEdit(e.row)}}},[t._v("编辑")]),a("el-button",{attrs:{size:"mini"},on:{click:function(a){return t.agentDetail(e.row)}}},[t._v("详情")]),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return t.agentDeleteok(e.row)}}},[t._v("删除")]),a("el-button",{attrs:{size:"mini",type:1===parseInt(e.row.status)?"success":"danger"},on:{click:function(a){return t.changerStatus(e.row)}}},[t._v(" "+t._s(1===parseInt(e.row.status)?"启":"停"))])]}}])})],1),a("el-pagination",{staticStyle:{"margin-top":"6px"},attrs:{"page-size":t.pagination.pageSize,layout:"prev, pager, next, jumper",total:t.pagination.total}})],1)},n=[],i=(a("99af"),a("fb6a"),a("b0c0"),a("b64b"),a("d3b7"),a("e25e"),a("25f0"),a("159b"),a("9bd2"));function r(t){return Object(i["a"])({url:"/agent/".concat(t),method:"delete"})}function s(t){return Object(i["a"])({url:"/agent/loginTo?user_id=".concat(t),method:"get"})}function l(t){return void 0===t.companyName?Object(i["a"])({url:"/agent?page=".concat(t.page),method:"get",data:t}):Object(i["a"])({url:"/agent?page=".concat(t.page,"&companyName=").concat(t.companyName),method:"get",data:t})}function c(t){return Object(i["a"])({url:"/agent/child?user_id=".concat(t),method:"get"})}var u=a("50c6"),m={data:function(){var t=this,e=function(e,a,o){0===t.checkimg?o(new Error("请上传图片")):o()};return{dialogFormVisibleok:!1,formdata:{ordernum:"",type:"",account:"",accountabout:"",qd:"",time:"",company:"",note:""},dialogFormVisible2:!1,title:"",uploadAction:"/agent/20",fileList:[],checkimg:"",dialogImageUrl:"",dialogVisible:!1,checkname:"",au:!1,sitearra:"",sitearr:[],checkid:2===parseInt(this.$util.cookies.get("uid")),active:0,rules:{domain:[{required:!0,message:"必填"},{pattern:/^(?=^.{3,255}$)[a-zA-Z0-9][-a-zA-Z0-9]{0,62}(\.[a-zA-Z0-9][-a-zA-Z0-9]{0,62})+$/,message:"请输入正确的域名格式",trigger:"blur"}],level:[{required:!0,message:"必填"},{type:"number",min:1,trigger:"blur"}],logo:[{validator:e,trigger:"blur"}]},rulesForm:{companyName:"",domain:"",level:""},rulesForm2:{companyName:"",domain:"",level:"",created_at:"",tel:""},stdata:{id:"",status:""},loading:!0,pagination:{background:!0,currentPage:parseInt(localStorage.getItem("agentcontrolcurrentPage"))||1,pageSize:15,total:0,pageCount:""},tableData1:[]}},created:function(){this.$util.authen(["null",0,2]);var t=this;document.onkeydown=function(e){var a=window.event.keyCode;13===a&&t.searchok()}},mounted:function(){this.fetchData({page:this.pagination.currentPage})},computed:{detailTitle:function(){return"【".concat(this.rulesForm2.companyName,"】代理详情：")},paramsData:function(){var t={domain:this.rulesForm.domain,level:this.rulesForm.level,companyName:this.rulesForm.companyName};return t},spanok:function(){return document.body.clientWidth>1500?8:10},offsetok:function(){return document.body.clientWidth>1500?8:7}},watch:{dialogFormVisible2:function(){!1===this.dialogFormVisible2&&(this.fileList=[])}},methods:{handleCurrentChange:function(t){console.log("当前页: ".concat(t))},searchok:function(){var t={page:1};t.companyName=this.formdata.name,this.fetchData(t)},searchok2:function(){var t={page:1};this.fetchData(t),this.emptysearch()},emptysearch:function(){var t=this;Object.keys(this.formdata).forEach((function(e){t.formdata[e]=""}))},agentDetail:function(t){this.dialogFormVisibleok=!0,this.rulesForm2.companyName=t.companyName,this.rulesForm2.domain=t.domain,this.rulesForm2.id=t.id,this.rulesForm2.level=parseInt(t.level),this.title="【".concat(t.companyName,"】代理详情")},agentLogin:function(t){var e=this;s(t.user_id).then((function(t){window.open("http://".concat(t))})).catch((function(t){console.log("err",t),e.$notify({message:"接口失败"})}))},agentEdit:function(t){this.dialogFormVisible2=!0,this.rulesForm.companyName=t.companyName,this.rulesForm.domain=t.domain,this.rulesForm.id=t.id,this.rulesForm.level=parseInt(t.level),this.title="【".concat(t.companyName,"】代理编辑")},agentDeleteok:function(t){var e=this,a=this.$createElement,o=this,n="你正在删除【".concat(t.companyName,"】【").concat(t.domain,"】"),i="你已成功删除【".concat(t.companyName,"】【").concat(t.domain,"】");this.$confirm(n,"代理删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){r(t.id).then((function(t){e.$notify({title:"删除",duration:6e3,type:"success",message:a("b",{style:"color: teal"},i)}),o.fetchData()})).catch((function(t){console.log("err",t),e.loading=!1,e.$notify({message:"接口失败"})}))})).catch((function(){}))},changerStatus:function(t){var e=this,a=this.$createElement,o=parseInt(t.status);if(1===o){var n="你正在禁用【".concat(t.companyName,"】，禁用之后将无法登录，你确定要这么做吗？"),i="你已成功禁用【".concat(t.companyName,"】");this.$confirm(n,"禁用",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.stdata.status=0,e.stdata.id=t.user_id,Object(u["a"])(e.stdata).then((function(e){t.status=0})).catch((function(t){console.log("err",t),e.loading=!1,e.$notify({message:"接口失败"})})),e.$notify({title:"禁用",duration:6e3,type:"error",message:a("b",{style:"color: teal"},i)}),t.status=!t.status})).catch((function(){}))}else{this.stdata.status=1,this.stdata.id=t.user_id,Object(u["a"])(this.stdata).then((function(e){t.status=1})).catch((function(t){console.log("err",t),e.loading=!1,e.$notify({message:"接口失败"})}));var r="你已经启用【".concat(t.companyName,"】服务");this.$notify({title:"启用服务",duration:6e3,type:"success",message:a("b",{style:"color: teal"},r)}),t.status=!t.status}},load:function(t,e,a){var o=this;c(t.user_id).then((function(t){for(var e=t.data,o=0;o<e.length;o++)e[o].hasChildren=!0,e[o].try=Math.random().toString(36).slice(-8);a(e)})).catch((function(t){console.log("err",t),o.loading=!1,o.$notify({message:"获取数据失败"})}))},fetchData:function(t){var e=this;this.loading=!0;var a=this;l(t).then((function(t){for(var e=t.data,o=0;o<e.length;o++)e[o].hasChildren=!0,e[o].try=Math.random().toString(36).slice(-8);a.tableData1=e,a.pagination.total=parseInt(t.total),a.pagination.pageCount=parseInt(t.last_page),a.loading=!1})).catch((function(t){console.log("err",t),e.loading=!1,e.$notify({message:"获取数据失败"})}))},createerror:function(){this.$notify({title:"代理创建失败",type:"error",duration:7e3})},createSuccess:function(t){var e=this.$createElement,a="代理".concat(this.rulesForm.username,"【").concat(this.rulesForm.company,"】更新成功");this.reset(),this.$notify({title:"代理创建成功",type:"success",duration:0,message:e("b",{style:"color: teal"},a)})},beforeUploadPicture:function(t){var e="image/png"==t.type||"image/jpg"==t.type||"image/jpeg"==t.type,a=t.size<2097152;return e||this.$message.error("上传只能是jpg,jpeg,png格式"),a||this.$message.error("上传图片大小不能超过 2MB"),e&&a},handlePictureCardPreview:function(t){this.dialogImageUrl=t.url,this.dialogVisible=!0},handleRemovePicture:function(t,e){this.checkimg=e.length},imageChange:function(t,e,a){this.checkimg=e.length},next1:function(){var t=this;this.$refs.rulesForm.validate((function(e){e&&t.submitForm()}))},submitForm:function(){var t=this,e=this,a=this.$createElement,o=this.rulesForm,n=o.companyName,i=o.domain,r=o.level,s=["绑定域名：".concat(i),"代理层级：".concat(r),"公司名：".concat(n)],l=[];for(var c in s)l.push(a("p",null,s[c]));var u=a("div",null,l);this.$confirm(u,"代理更新",{confirmButtonText:"确定",cancelButtonText:"取消",type:"success"}).then((function(){e.$refs.upload.submit(),console.log(1)})).catch((function(){t.$notify({title:"代理更新取消",type:"info"})}))},reset:function(){var t=this;Object.keys(this.rulesForm).forEach((function(e){t.rulesForm[e]=""})),this.$refs.upload.clearFiles()}}},d=m,p=(a("f144"),a("0c7c")),h=Object(p["a"])(d,o,n,!1,null,"a02ea4c6",null);e["default"]=h.exports},e25e:function(t,e,a){var o=a("23e7"),n=a("e583");o({global:!0,forced:parseInt!=n},{parseInt:n})},e583:function(t,e,a){var o=a("da84"),n=a("58a8").trim,i=a("5899"),r=o.parseInt,s=/^[+-]?0[Xx]/,l=8!==r(i+"08")||22!==r(i+"0x16");t.exports=l?function(t,e){var a=n(String(t));return r(a,e>>>0||(s.test(a)?16:10))}:r},f144:function(t,e,a){"use strict";var o=a("515f"),n=a.n(o);n.a}}]);